<!-- ppt.html -->
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PowerPoint-Generator</title>
  <style>
    :root { --bg:#0b1022; --panel:#0f172a; --muted:#94a3b8; --border:rgba(148,163,184,.3); --accent:#3b82f6; --accent2:#1d4ed8; --text:#e5e7eb; }
    *{box-sizing:border-box}
    body{font-family:Arial, sans-serif;background:var(--bg);color:var(--text);display:flex;flex-direction:column;align-items:center;min-height:100vh;margin:0;padding:30px}
    h1{margin:0 0 8px}
    p.hint{color:var(--muted);margin:0 0 8px}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-bottom:10px}
    input,button{border-radius:10px;font-size:14px;border:1px solid var(--border);background:var(--panel);color:var(--text);padding:10px}
    .status{font-size:13px;color:var(--muted);margin-top:8px;min-height:18px}
    .err{color:#fca5a5}
    .models{display:grid;grid-template-columns:repeat(auto-fill,minmax(230px,1fr));gap:12px;width:90%;max-width:1100px;margin:10px 0}
    .card{border:1px solid var(--border);background:var(--panel);border-radius:12px;padding:12px;cursor:pointer;transition:transform .05s ease}
    .card:hover{transform:translateY(-1px)}
    .card.active{outline:2px solid var(--accent)}
    .top{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
    .name{font-weight:bold}
    .badge{font-size:12px;color:#cbd5e1}
    .bar{height:8px;background:#0e152e;border-radius:6px;overflow:hidden;margin:8px 0}
    .fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2));width:0%}
    .meta{font-size:12px;color:#9fb1cc}
    img.logo{width:120px;border-radius:12px;margin-bottom:10px}
  </style>
  <link rel="icon" href="/static/logo.jpg">
</head>
<body>
  <a href="/"><img src="/static/logo.jpg" alt="Logo" class="logo" onerror="this.style.display='none'"></a>
  <h1>ðŸ§  PowerPoint-Generator</h1>

  <div class="row">
    <input id="topic" placeholder="Thema, z. B. Klimawandel â€“ Grundlagen" style="min-width:320px">
    <input id="target" placeholder="Zielgruppe, z. B. 9. Klasse Gymnasium" style="min-width:280px">
    <input id="slides" type="number" min="5" max="25" value="10" style="width:120px">
  </div>

  <div class="models" id="models"></div>
  <div class="row">
    <button id="go">PPTX erzeugen</button>
  </div>

  <div class="status" id="status"></div>

  <script>
    const $ = s => document.querySelector(s);
    const statusEl = $("#status");
    const modelsEl = $("#models");

    let selectedModel = "qwen3-coder:480b-cloud";
    let maxTokens = 1500;
    let temperature = 0.25;

    const PRESETS = {
      "deepseek-v3.1:671b-cloud": {label:"DeepSeek V3.1", context_window:65536, ideal_max:2200, cap:8000, temp:0.30, note:"Outline lÃ¤nger mÃ¶glich"},
      "qwen3-coder:480b-cloud":   {label:"Qwen3 Coder",   context_window:131072,ideal_max:1500, cap:8192, temp:0.25, note:"stabil fÃ¼r strukturierte JSON-Outlines"},
      "glm-4.6:cloud":            {label:"GLM-4.6",       context_window:131072,ideal_max:1500, cap:8192, temp:0.35, note:"guter Kompromiss"},
      "gpt-oss:120b-cloud":       {label:"GPT-OSS 120B",  context_window:65536, ideal_max:1400, cap:8192, temp:0.35, note:"solide"},
      "qwen3-vl:235b-cloud":      {label:"Qwen3-VL",      context_window:262144,ideal_max:1500, cap:6144, temp:0.35, note:"VL optional"},
      "minimax-m2:cloud":         {label:"MiniMax-M2",    context_window:200000,ideal_max:1200, cap:8192, temp:0.35, note:"schnell"},
      "gpt-oss:20b-cloud":        {label:"GPT-OSS 20B",   context_window:32768, ideal_max:900,  cap:4096, temp:0.45, note:"klein"}
    };

    function setStatus(m, err=false){ statusEl.textContent=m||""; statusEl.className="status"+(err?" err":""); }

    function renderModelCards(){
      modelsEl.innerHTML = "";
      Object.entries(PRESETS).forEach(([key, p])=>{
        const card = document.createElement("div");
        card.className = "card" + (key===selectedModel ? " active":"");
        card.innerHTML = `
          <div class="top">
            <div class="name">${p.label}</div>
            <div class="badge">${(p.context_window/1024).toFixed(0)}k ctx</div>
          </div>
          <div class="bar"><div class="fill" style="width:${Math.min(100, (p.ideal_max/p.cap)*100)}%"></div></div>
          <div class="meta">ideal: ${p.ideal_max} â€¢ cap: ${p.cap} â€¢ temp: ${p.temp}<br><span style="opacity:.8">${p.note}</span></div>
        `;
        card.addEventListener("click", ()=>{
          document.querySelectorAll(".card").forEach(c=>c.classList.remove("active"));
          card.classList.add("active");
          selectedModel = key; maxTokens = p.ideal_max; temperature = p.temp;
          setStatus(`Modell: ${p.label} â€¢ ctx ${(p.context_window/1024).toFixed(0)}k â€¢ max_tokens ${p.ideal_max}`);
        });
        modelsEl.appendChild(card);
      });
    }
    renderModelCards();

    $("#go").addEventListener("click", async ()=>{
      const topic = $("#topic").value.trim();
      const target = $("#target").value.trim();
      const slides = parseInt($("#slides").value||"10",10);
      if(!topic){ setStatus("Bitte Thema eingeben.", true); return; }
      setStatus("Erzeuge PPTX â€¦");
      try{
        const r = await fetch("/ppt_generate", {
          method:"POST",
          headers:{"Content-Type":"application/json"},
          body: JSON.stringify({
            topic, target, slides,
            model: selectedModel, temperature
          })
        });
        if(!r.ok){
          const t = await r.text();
          throw new Error(`HTTP ${r.status} â€“ ${t.slice(0,300)}`);
        }
        const blob = await r.blob();
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url; a.download = "slides.pptx"; a.click();
        URL.revokeObjectURL(url);
        setStatus("PPTX gespeichert.");
      }catch(e){
        console.error(e);
        setStatus("Fehler: "+e.message, true);
      }
    });
  </script>
</body>
</html>
